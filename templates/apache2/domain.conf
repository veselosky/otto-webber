{% if redirect_domain -%}
<VirtualHost *:80>
ServerName {{ redirect_domain }}
Redirect permanent / http://{{ servername }}/
</VirtualHost>
{%- endif -%}

<VirtualHost *:80>
ServerName {{ servername }}
DocumentRoot {{ install_path }}/{{ documentroot }}

# TODO Decide how to handle logging. For now, use global config.
# CustomLog /var/log/apache2/{{ servername }}-access.log combined

# Main content area
<Directory {{ install_path }}/{{ documentroot }}>
    Options FollowSymLinks
    AllowOverride All
    Order allow,deny
    Allow from All
</Directory>

{% if cgi %}
ScriptAlias cgi-bin {{ install_path }}/{{ cgi }}
{% endif %}

{% if fcgi %}
# FIXME Need proper FCGI configuration!
ScriptAlias fcgi-bin {{ install_path }}/{{ fcgi }}
{% endif %}

# TODO Move this to .htaccess
# Conditional ENV for SSI magics
BrowserMatchNoCase MSIE MSIE
BrowserMatchNoCase Windows WINDOWS

</VirtualHost>
